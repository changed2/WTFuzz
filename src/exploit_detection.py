import signal
import os

def crash_log(returncode, error, payload):
    summary = ''
    summary += '=' * 30 + ' PROGRAM CRASH DETECTED ' + '=' * 30 + '\n'
    signal_number = -returncode

    if signal_number == signal.SIGSEGV:
        summary += 'The program crashed with a segmentation fault\n'
    elif signal_number == signal.SIGABRT:
        summary += 'The program terminated by aborting\n'
    else:
        summary += 'Other error'
    
    # Inspect the error message to figure out the type of vulnerability.
    if ('stack smashing' in error):
        summary += 'buffer overflow with stack canary detected\n'
    
    summary += 'Fuzzing terminated, writing payload to <textfile>'

    print(summary)